<!-- prettier-ignore -->
{% extends "base.html" %} 
{% block title %}Dash{% endblock %} 
{% block content %}
<div class="w-full min-h-screen flex items-center justify-center">
  <div class="overflow-x-auto">
    <h1 class="text-center mb-4">Dash</h1>

    <!-- Drag and Drop File Upload Form -->
    <form
      id="upload-form"
      action="/api/upload"
      method="post"
      enctype="multipart/form-data"
      hx-post="/api/upload"
      hx-target="#upload-result"
      hx-encoding="multipart/form-data"
    >
      <div
        id="drop-area"
        class="border-2 border-dashed p-6 bg-gray-100 max-w-md mx-auto text-center"
        hx-on="drop:preventDefault"
        ondrop="handleDrop(event)"
        ondragover="handleDragOver(event)"
      >
        <p>Drag and drop your CSV file here or click to upload.</p>
        <input type="file" name="csv" id="file-input" class="hidden" />
      </div>
    </form>

    <!-- Upload Result -->
    <div id="upload-result" class="max-w-md mx-auto mt-4"></div>
  </div>
</div>

<script>
  // Handle the drop event
  function handleDrop(event) {
    event.preventDefault();
    const file = event.dataTransfer.files[0];
    if (file && file.type === "text/csv") {
      const input = document.getElementById("file-input");
      input.files = event.dataTransfer.files;
      input.form.submit(); // Submit form when a file is dropped
    } else {
      alert("Please drop a CSV file.");
    }
  }

  // Handle the drag over event to allow dropping
  function handleDragOver(event) {
    event.preventDefault();
  }

  // Trigger the file input when the user clicks the drop area
  document.getElementById("drop-area").addEventListener("click", function () {
    document.getElementById("file-input").click();
  });
</script>
{% endblock %}
